---
import RootLayout from "@layouts/RootLayout.astro";
import { createServerCaller } from "@/trpc/server";
import Schedule from "./page.tsx";

const currentUser = Astro.locals.user;
if (!currentUser) return null;
const caller = await createServerCaller(Astro.request);

let courses = await caller.courses.getCourseAttachments();
let { data: holidays } = await caller.holidays.getAll();
const isAuthorized = currentUser?.role === "INSTRUCTOR" || currentUser?.role === "MENTOR" || false;
---

<RootLayout title="Events">
   <Schedule courses={courses} holidays={holidays} isAuthorized={isAuthorized} client:load />
</RootLayout>
