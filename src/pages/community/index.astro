---
import ReactLayout from "@/layouts/RootLayout.astro";
import Page from "./page";
import { createServerCaller } from "@/trpc/server";

const currentuser = Astro.locals.user;
if (!currentuser) return null;

const caller = await createServerCaller(Astro.request);
const allDoubts = await caller.courses.getAllDoubts();
---

<ReactLayout title="Community Forum">
  <Page allDoubts={allDoubts} currentUser={currentuser} client:load />
</ReactLayout>
