---
import { NOTIFICATION_HREF_MAP } from "@/components/Notifications";
import RootLayout from "@/layouts/RootLayout.astro";
import { createServerCaller } from "@/trpc/server";
import Page from './page'

const id = Astro.params.id;
if (!id) {
  return Astro.redirect("/notifications");
}


const caller = await createServerCaller(Astro.request);
const notification =await caller.notifications.getNotificationById({id});

if (!notification) {
  return Astro.redirect("/notifications");
}

const notifcationlink = NOTIFICATION_HREF_MAP[notification.eventType] as unknown as string;

return Astro.redirect(notifcationlink);
---

<RootLayout title="Redirecting...">
  <Page notifcationlink={notifcationlink} client:load />
</RootLayout>
