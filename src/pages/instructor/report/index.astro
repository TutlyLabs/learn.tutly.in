---
import RootLayout from "@/layouts/RootLayout.astro";
import Page from "./page";
import { createServerCaller } from "@/trpc/server";

const caller = await createServerCaller(Astro.request);
const courses = await caller.courses.getEnrolledCourses();

const firstCourseId = courses?.data?.[0]?.id;

if (!firstCourseId) {
  return Astro.redirect("/instructor/no-courses", 302);
}

return Astro.redirect(`/instructor/report/${firstCourseId}`, 302);
---

<RootLayout title="Report">
  <Page firstCourseId={firstCourseId} client:load />
</RootLayout>
